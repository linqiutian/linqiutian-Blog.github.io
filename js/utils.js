(function(e){"use strict";function t(o,i,r){if(typeof o!=="function"){throw new TypeError("Expected a function")}i=i||300;let c=null;let s;function e(...e){const t=this;const n=r&&!c;if(c){clearTimeout(c)}c=setTimeout(function(){c=null;if(!r){s=o.apply(t,e)}},i);if(n){s=o.apply(t,e)}return s}e.cancel=function(){if(c){clearTimeout(c);c=null}};return e}function n(i,r,e){if(typeof i!=="function"){throw new TypeError("Expected a function")}r=r||100;e=e||{};const c=e.leading!==false;const s=e.trailing!==false;let l=null;let a=0;let u=null;let f=null;function t(...e){const t=this;const n=Date.now();const o=r-(n-a);u=e;f=t;if(o<=0||o>r){if(l){clearTimeout(l);l=null}a=n;if(c){i.apply(t,e)}}else if(!l&&s){l=setTimeout(function(){a=c?Date.now():0;l=null;i.apply(f,u);u=null;f=null},o)}}t.cancel=function(){if(l){clearTimeout(l);l=null}a=0;u=null;f=null};return t}const o={isMobile:function(){return window.innerWidth<=768||/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},isTablet:function(){return/iPad|Android/i.test(navigator.userAgent)&&window.innerWidth>768&&window.innerWidth<=1024},isDesktop:function(){return!this.isMobile()&&!this.isTablet()},isTouchDevice:function(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0},prefersReducedMotion:function(){return window.matchMedia("(prefers-reduced-motion: reduce)").matches},prefersDarkMode:function(){return window.matchMedia("(prefers-color-scheme: dark)").matches},getDeviceType:function(){if(this.isMobile())return"mobile";if(this.isTablet())return"tablet";return"desktop"},getScreenInfo:function(){return{width:window.innerWidth,height:window.innerHeight,pixelRatio:window.devicePixelRatio||1,orientation:window.innerWidth>window.innerHeight?"landscape":"portrait"}}};const i={getLoadMetrics:function(){if(!window.performance||!window.performance.timing){console.warn("[Utils] Performance API 不支持");return null}const e=window.performance.timing;const t=e.navigationStart;return{dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,request:e.responseEnd-e.requestStart,domParse:e.domInteractive-e.responseEnd,domComplete:e.domComplete-e.domInteractive,loadComplete:e.loadEventEnd-t,ttfb:e.responseStart-t,whiteScreen:e.domLoading-t,interactive:e.domInteractive-t}},getCoreWebVitals:function(o){if(!("PerformanceObserver"in window)){console.warn("[Utils] PerformanceObserver 不支持");return}const i={lcp:null,fid:null,cls:null};try{const e=new PerformanceObserver(function(e){const t=e.getEntries();const n=t[t.length-1];i.lcp=n.startTime;if(o){o({type:"lcp",value:i.lcp})}});e.observe({type:"largest-contentful-paint",buffered:true})}catch(e){console.warn("[Utils] LCP 观察器创建失败:",e)}try{const t=new PerformanceObserver(function(e){const t=e.getEntries();const n=t[0];i.fid=n.processingStart-n.startTime;if(o){o({type:"fid",value:i.fid})}});t.observe({type:"first-input",buffered:true})}catch(e){console.warn("[Utils] FID 观察器创建失败:",e)}try{let n=0;const r=new PerformanceObserver(function(e){const t=e.getEntries();t.forEach(function(e){if(!e.hadRecentInput){n+=e.value}});i.cls=n;if(o){o({type:"cls",value:i.cls})}});r.observe({type:"layout-shift",buffered:true})}catch(e){console.warn("[Utils] CLS 观察器创建失败:",e)}return i},getResourceStats:function(){if(!window.performance||!window.performance.getEntriesByType){return null}const e=window.performance.getEntriesByType("resource");const n={total:e.length,totalSize:0,byType:{}};e.forEach(function(e){const t=e.initiatorType||"other";if(!n.byType[t]){n.byType[t]={count:0,totalDuration:0,totalSize:0}}n.byType[t].count++;n.byType[t].totalDuration+=e.duration;if(e.transferSize){n.byType[t].totalSize+=e.transferSize;n.totalSize+=e.transferSize}});return n},logPerformanceReport:function(){console.group("[Performance Report]");const e=this.getLoadMetrics();if(e){console.log("页面加载指标:",e)}const t=this.getResourceStats();if(t){console.log("资源统计:",t)}console.groupEnd()}};function r(e,t){try{return JSON.parse(e)}catch(e){return t!==undefined?t:null}}function c(e){e=e||"id";return e+"_"+Date.now().toString(36)+"_"+Math.random().toString(36).substr(2,9)}function s(e,t){t=t||0;const n=e.getBoundingClientRect();return n.top>=-t&&n.left>=-t&&n.bottom<=(window.innerHeight||document.documentElement.clientHeight)+t&&n.right<=(window.innerWidth||document.documentElement.clientWidth)+t}function l(e,t){t=t||0;const n=typeof e==="string"?document.querySelector(e):e;if(!n)return;const o=n.getBoundingClientRect().top+window.pageYOffset-t;window.scrollTo({top:o,behavior:"smooth"})}const a={debounce:t,throttle:n,device:o,performance:i,safeJsonParse:r,generateId:c,isInViewport:s,scrollToElement:l};e.Utils=a;console.log("[Utils] 工具函数模块已加载")})(typeof window!=="undefined"?window:this);